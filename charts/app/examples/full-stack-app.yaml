# Full-stack application with storage, database, and cache
# Dev escolhe engines e flavors - plataforma decide a cloud!
#
# helm install my-app ./charts/app -f examples/full-stack-app.yaml -n prod

app:
  name: ecommerce-api
  team: ecommerce-team
  costCenter: CC-ECOM-001

image:
  repository: my-registry/ecommerce-api
  tag: "v2.5.0"

replicaCount: 5

autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 20
  targetCPUUtilizationPercentage: 70

container:
  port: 8080
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi
  env:
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: ecommerce-api-database
          key: connection-string
    - name: REDIS_URL
      valueFrom:
        secretKeyRef:
          name: ecommerce-api-cache
          key: connection-string
    - name: STORAGE_ENDPOINT
      valueFrom:
        secretKeyRef:
          name: ecommerce-api-storage
          key: endpoint

service:
  type: ClusterIP
  port: 80

ingress:
  enabled: true
  className: alb
  hosts:
    - host: api.ecommerce.com
      paths:
        - path: /
          pathType: Prefix

# Full infrastructure provisioning
infrastructure:
  enabled: true

  # Storage para assets/uploads
  storage:
    enabled: true
    flavor: standard      # standard | premium | economy | archive
    size: 500Gi
    encryption: true
    versioning: true

  # PostgreSQL para dados
  database:
    enabled: true
    engine: postgres      # postgres | mysql
    flavor: large         # small | medium | large | xlarge
    version: "15"
    storageSize: 100
    highAvailability: true
    backupRetentionDays: 30

  # Redis para cache/sess√µes
  cache:
    enabled: true
    engine: redis         # redis | memcached
    flavor: medium        # small | medium | large
    highAvailability: true
